.PHONY: up down build logs restart clean db-logs db-shell lint-back format-back<%_ if (dbAdmin && dbAdmin.tool === 'pgadmin') { %> pgadmin-logs pgadmin-restart<%_ } else if (dbAdmin && dbAdmin.tool === 'adminer') { %> adminer-logs adminer-restart<%_ } %>

# Start all services
up:
	docker compose up -d

# Stop all services
down:
	docker compose down

# Build all services
build:
	docker compose build

# View logs (all services)
logs:
	docker compose logs -f

# Restart all services
restart:
	docker compose restart

# Clean everything (volumes included)
clean:
	docker compose down -v

# Database commands
db-logs:
	docker compose logs -f postgres

db-shell:
	docker compose exec postgres psql -U <%= dbUser %> -d <%= dbName %>

# Backend commands
backend-logs:
	docker compose logs -f backend

backend-shell:
	docker compose exec backend sh

lint-back:
	docker compose exec backend npm run lint

format-back:
	docker compose exec backend npm run format
<%_ for (const fe of frontends) { %>
# <%= fe.name %> commands
<%= fe.name %>-logs:
	docker compose logs -f <%= fe.name %>

<%= fe.name %>-shell:
	docker compose exec <%= fe.name %> sh
<%_ } %>
<%_ if (dbAdmin && dbAdmin.tool === 'pgadmin') { %>
# pgAdmin commands
pgadmin-logs:
	docker compose logs -f pgadmin

pgadmin-restart:
	docker compose restart pgadmin
<%_ } else if (dbAdmin && dbAdmin.tool === 'adminer') { %>
# Adminer commands
adminer-logs:
	docker compose logs -f adminer

adminer-restart:
	docker compose restart adminer
<%_ } %>
