---
name: migrate-vue-component
description: Migrate a Vue component to Composition API with TypeScript, then review and refactor
created: 2024-01-15T10:00:00
---

# Command: Migrate Vue Component

## Description
This command automates the complete migration of a Vue 2 component to Vue 3 with Composition API and TypeScript, including code review and refactoring based on feedback.

## Parameters
parameters:
  - name: component_name
    type: string
    required: true
    description: Name of the component to migrate (e.g., UserProfile, ProductCard)
    
  - name: component_path
    type: string
    required: false
    description: Relative path to the component file
    default: ""

## Workflow
workflow:
  # Step 1: Migrate to Composition API + TypeScript
  - step: migrate_to_composition_ts
    agent: vue-developer
    description: Convert Vue 2 Options API to Vue 3 Composition API with TypeScript
    prompt: |
      Convert the component {{component_name}} to Vue 3 Composition API with TypeScript.
      
      Requirements:
      - Use <script setup> syntax
      - Add full TypeScript type annotations
      - Convert all refs, computed, and methods
      - Update lifecycle hooks to Composition API equivalents
      - Ensure reactivity is properly maintained
      
      {{#if component_path}}
      Component path: {{component_path}}
      {{/if}}
    output_variable: migrated_code
    on_error: stop
    
  # Step 2: Review the migrated code
  - step: review_migration
    agent: code-reviewer
    description: Perform comprehensive code review of the migrated component
    prompt: |
      Review this Vue 3 component that was just migrated from Vue 2 Options API.
      
      Focus on:
      - Proper use of Composition API patterns
      - TypeScript type safety (no 'any' types)
      - Reactivity correctness (ref vs reactive)
      - Performance considerations
      - Code organization and readability
      - Potential bugs or issues
      
      Migrated code:
      {{migrated_code}}
    output_variable: review_report
    on_error: stop
    
  # Step 3: Refactor based on review (only if issues found)
  - step: refactor_if_needed
    agent: vue-developer
    description: Apply refactoring based on code review feedback
    condition: "review_report contains 'issue'"
    prompt: |
      Refactor the migrated component based on this code review:
      
      Review feedback:
      {{review_report}}
      
      Current code:
      {{migrated_code}}
      
      Apply all critical fixes and recommended improvements while maintaining functionality.
    output_variable: refactored_code
    on_error: retry
    retry_count: 2
    
  # Step 4: Final validation
  - step: final_validation
    agent: code-reviewer
    description: Validate the final code quality
    prompt: |
      Perform a final quality check on this component.
      
      {{#if refactored_code}}
      Final code (after refactoring):
      {{refactored_code}}
      {{else}}
      Final code (no refactoring needed):
      {{migrated_code}}
      {{/if}}
      
      Verify:
      - All TypeScript types are correct
      - No eslint or compiler errors
      - Follows Vue 3 best practices
      - Ready for production
    output_variable: final_validation
    on_error: stop

## Output Configuration
output:
  format: markdown
  variables:
    - migrated_code
    - refactored_code
    - review_report
    - final_validation
  save_to: .claude/command-outputs/migrate-{{component_name}}-{{timestamp}}.md

## Usage Examples

### Migrate a component by name:
```bash
python scripts/execute_workflow.py .claude/commands/migrate-vue-component.yaml \
  --param component_name=UserProfile
```

### Migrate with specific path:
```bash
python scripts/execute_workflow.py .claude/commands/migrate-vue-component.yaml \
  --param component_name=ProductCard \
  --param component_path=src/components/ProductCard.vue
```

## Expected Output

The command will generate a markdown file with:
- The migrated Vue 3 + TypeScript code
- Code review feedback
- Refactored code (if issues were found)
- Final validation report

## Notes
- This command requires the `vue-developer` and `code-reviewer` agents
- Typical execution time: 3-5 minutes per component
- The component should be compatible with Vue 3
- Manual testing is still recommended after migration
